<div class="aqi-container-block grey lighten-5">
  <h5 class="aqi-header block-header">ข้อมูลคุณภาพอากาศ (AQI)</h5>
  <p>
    ข้อมูลจาก <a href="https://aqicn.org" target="_blank" rel="noopener noreferrer">World Air Quality Index</a>, <a href="http://pcd.go.th/" target="_blank" rel="noopener noreferrer">กรมควบคุมมลพิษ</a> และ <a href="https://www.cmuccdc.org/" target="_blank" rel="noopener noreferrer">CMU CCDC</a>
    <br />จังหวัดที่ไม่ได้ระบุสถานที่หมายถึงอำเภอเมือง
    <br /><a href="https://www.notion.so/AQI-adb41c3a99a348368d2a9cba1e826007" target="_blank" rel="noopener noreferrer">ระดับคุณภาพอากาศ</a>
  </p>
  <div id="aqi-block" class="aqi-block grey lighten-5"></div>
  <h6>*กลุ่มอ่อนไหว = เด็ก, ผู้สูงอายุ, ผู้ป่วยโรคทางเดินหายใจ</h6>
</div>
<script>
(function(w, d, t, f) {
  w[f] = w[f] || function(c, k, n) {
    s = w[f], k = s['k'] = (s['k'] || (k ? ('&k=' + k) : ''));
    s['c'] =
      c = (c instanceof Array) ? c : [c];
    s['n'] = n = n || 0;
    L = d.createElement(t), e = d.getElementsByTagName(t)[0];
    L.async = 1;
    L.src = '//feed.aqicn.org/feed/' + (c[n].city) + '/' + (c[n].lang || '') + '/feed.v1.js?n=' + n + k;
    e.parentNode.insertBefore(L, e);
  };
})(window, document, 'script', '_aqiFeed');

var cities = [
  /* "bangkok",*/
  "thailand/tak/mae-sot/mae-pa/",
  "thailand/lampang-meteorological-station/",
  "thailand/lamphun/provincial-administrative-stadium/",
  "thailand/chiangmai/yupparaj-wittayalai-school/",
  "thailand/chiangmai/city-hall/",
  "thailand/chiangmai/maerim---prem/",
  "thailand/san-kamphaeng-hospital/",
  "thailand/samoeng-hospital/",
  "thailand/chai-prakan-hospital/",
  "thailand/hod-hospital/",
  "thailand/mae-hongson/natural-resources-and-environment-office/",
  "thailand/debaratana-hospital/",
  "thailand/khun-yuam-hospital/",
  "thailand/mae-hong-son/pai-hospital/",
  "thailand/chiangrai/natural-resources-and-environment-office/",
  "thailand/chiang-rai/mae-fah-luang-university/",
  "thailand/nan/municipality-office/",
  "thailand/phayao/knowledge-park/",
  /*"thailand/bangkok/chulalongkorn-hospital/",
  "thailand/bangkok/ratburana-post-office/",
  "thailand/bangkok/thai-meteorological-department-bangna/",
  "thailand/bangkok/thonburi-power-sub-station/",
  "thailand/bkk/saphan-khwai/",
  "thailand/bangkok/chokchai-police-station/",
  "thailand/pathum-thani/bangkok-university-rangsit-campus/",
  "thailand/samut-sakhon/provincial-administrative-organization/",
  "thailand/regional-environmental-office-8/",
  "thailand/chonburi/general-education-office/",
  "thailand/chonburi/laem-chabang-municipal-stadium/",
  "rayong",
  "thailand/saraburi/khao-noi-fire-station/",
  "thailand/ayutthaya/ayutthaya-witthayalai-school/",
  "thailand/nakhon-sawan/nakhonsawan-irrigation/",
  "thailand/khonkaen",
  "thailand/surat-thani/regional-environmental-office-14/",
  "thailand/narathiwat/city-hall/"*/
];
var aqiWidgetConfig = [];
cities.forEach(function(city) {
  aqiWidgetConfig.push({
    city: city,
    callback: displayCity,
  });
});
_aqiFeed(aqiWidgetConfig);

function displayCity(aqi) {

  //console.log(aqi);

  if (/Thonburi/i.test(aqi.cityname)) aqi.cityname = "วงเวียนใหญ่, กทม.";
  if (/Ratburana/i.test(aqi.cityname)) aqi.cityname = "ราษฎร์บูรณะ, กทม.";
  if (/Thai Meteorological/i.test(aqi.cityname)) aqi.cityname = "บางนา, กทม.";
  if (/Chulalongkorn/i.test(aqi.cityname)) aqi.cityname = "ศาลาแดง, กทม.";
  if (/Saphan Khwai/i.test(aqi.cityname)) aqi.cityname = "สะพานควาย, กทม.";
  if (/Chokchai/i.test(aqi.cityname)) aqi.cityname = "โชคชัย 4, กทม.";
  if (/Rangsit/i.test(aqi.cityname)) aqi.cityname = "ม.กรุงเทพ, ปทุมธานี";
  if (/Samut Sakhon/i.test(aqi.cityname)) aqi.cityname = "สมุทรสาคร";
  /* if (aqi.cityname === "Bangkok") aqi.cityname = "กรุงเทพฯ"; */
  if (/office 8/i.test(aqi.cityname)) aqi.cityname = "ราชบุรี";
  if (/General Education Office, Chonburi/i.test(aqi.cityname)) aqi.cityname = "ชลบุรี";
  if (/Laem Chabang/i.test(aqi.cityname)) aqi.cityname = "แหลมฉบัง, ชลบุรี";
  if (aqi.cityname === "Rayong") aqi.cityname = "ระยอง";
  if (/Saraburi/i.test(aqi.cityname)) aqi.cityname = "สระบุรี";
  if (/Ayutthaya/i.test(aqi.cityname)) aqi.cityname = "พระนครศรีอยุธยา";
  if (/nakhonsawan/i.test(aqi.cityname)) aqi.cityname = "นครสวรรค์";
  if (/Tak/i.test(aqi.cityname)) aqi.cityname = "แม่สอด, ตาก";
  if (/Lampang/i.test(aqi.cityname)) aqi.cityname = "ลำปาง";
  if (/Lamphun/i.test(aqi.cityname)) aqi.cityname = "ลำพูน";
  if (/Yupparaj/i.test(aqi.cityname)) aqi.cityname = "ท่าแพ, เชียงใหม่";
  if (/City Hall, Chiangmai/i.test(aqi.cityname)) aqi.cityname = "ศูนย์ราชการ, เชียงใหม่";
  if (/MaeRim/i.test(aqi.cityname)) aqi.cityname = "แม่ริม, เชียงใหม่";
  if (/San Kamphaeng/i.test(aqi.cityname)) aqi.cityname = "สันกำแพง, เชียงใหม่";
  if (/Samoeng/i.test(aqi.cityname)) aqi.cityname = "สะเมิง, เชียงใหม่";
  if (/Debaratana Hospital/i.test(aqi.cityname)) aqi.cityname = "แม่แจ่ม, เชียงใหม่";
  if (/Chai Prakan/i.test(aqi.cityname)) aqi.cityname = "ไชยปราการ, เชียงใหม่";
  if (/Hod/i.test(aqi.cityname)) aqi.cityname = "ฮอด, เชียงใหม่";
  if (/Mae Hongson/i.test(aqi.cityname)) aqi.cityname = "แม่ฮ่องสอน";
  if (/Khun Yuam/i.test(aqi.cityname)) aqi.cityname = "ขุนยวม, แม่ฮ่องสอน";
  if (/Pai/i.test(aqi.cityname)) aqi.cityname = "ปาย, แม่ฮ่องสอน";
  if (/Chiangrai/i.test(aqi.cityname)) aqi.cityname = "เชียงราย";
  if (/Mae Fah Luang /i.test(aqi.cityname)) aqi.cityname = "ม.แม่ฟ้าหลวง, เชียงราย";
  if (/Nan/i.test(aqi.cityname)) aqi.cityname = "น่าน";
  if (/Phayao/i.test(aqi.cityname)) aqi.cityname = "พะเยา";
  if (aqi.cityname === "Khonkaen") aqi.cityname = "ขอนแก่น";
  if (/Surat/i.test(aqi.cityname)) aqi.cityname = "สุราษฎร์ธานี";
  if (/Narathiwat/i.test(aqi.cityname)) aqi.cityname = "นราธิวาส";
  if (aqi.impact === "Good") aqi.impact = "คุณภาพดี";
  if (aqi.impact === "Moderate") aqi.impact = "คุณภาพปานกลาง";
  if (aqi.impact === "Unhealthy for Sensitive Groups") aqi.impact = "ไม่ดีต่อกลุ่มอ่อนไหว*";
  if (aqi.impact === "Unhealthy") aqi.impact = "ไม่ดีต่อสุขภาพ";
  if (aqi.impact === "Very Unhealthy") aqi.impact = "ไม่ดีต่อสุขภาพมาก";
  if (aqi.impact === "Hazardous") aqi.impact = "อันตราย";
  if (aqi.impact === "no data") aqi.impact = "ไม่มีข้อมูล";

  $("#aqi-block").append(aqi.text(
    "<div class=\"aqi-display\"><div class=\"aqi-title\">%cityname</div><div style=\"%style;font-size:2em;padding:3px 8px;margin:10px 0;\">%aqi</div><p>%impact<br><small>%date</small></p></div>"
  ));
}

</script>
